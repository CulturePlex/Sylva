{% extends "base.html" %}
{# load i18n graphs static #}
{# get_static_prefix as STATIC_PREFIX #}

{% block navigation_buttons %}
  {{ block.super }}
{% endblock %}

{% block title %}
  {{ graph_slug }}
{% endblock %}

//<!-- not sure how to handle this-->
{# block menu_buttons #}
  {# toolbar on="reports" #}
{# endblock #}

{% block content_title %}
    <header class="reports-header">
        <h2>{{ graph_slug }} &raquo; Reports</h2>
    </header>
{% endblock %}

{% block content %}

    <div ng-app="reports" ng-controller="reportsListCtrl" resize>
        <div graph="{{ graph_slug }}" report="{{report_name}}" placeholder="{{ placeholder_name }}" init-report></div>
        <div class="content2-first content-col">
            <div ng-repeat="report in reports">
                <h2><a href="" ng-click="showReport(report.slug)">{$report.name$}</a></h2>
                {$ report.description $}
                
            </div>
        </div>  
        <div class="content-divider"></div>
        <div class="content2-second content-col">
            <div class="box">
                <div class="column1">
                <form id="report-form">
                    <div>
                        <h2 class="inline-h2">{$reportHeader$}</h2><a class="button report-button" ng-click="processForm(report)">Save report</a>
                        <a class="button report-button" ng-click="newReport()">New Report</a>
                    </div>
                    <div>
                        <label>Name:
                            <input class="sylva-borders" type="text" class="sylva-borders" ng-model="report.name" placeholder="{$ namePlaceholder $}">
                        </label>
                    </div>
                    <div>
                        <label>Frequency:
                            <select ng-model="report.frequency" class="sylva-borders">
                                <option value="daily">Daily</option>
                                <option value="weekly">Weekly</option>
                                <option value="monthly">Monthly</option>
                            </select>  
                        </label>                      
                    </div>
                    <div>
                        <label> Start date:
                            <input class="sylva-borders" type="text" date-time ng-model="report.startTime" required="true" view="hours"> 
                        </label>     
                    </div> 
                </form>
                </div> 
                <div class="column2">
                    <label>Description
                      <textarea class="sylva-borders" form="report-form" ng-model="report.description">
                      </textarea>
                    </label>
                </div>
            </div>
            <hr>
            <div>
                <div>
                    <h2> Add Queries </h2>
                </div>
                <div class="query-col">
                    <div ng-repeat="query in queries">
                        <div id="{$ query.name $}" draggable>
                            <h2>{$ query.name $}</h2>
                            Details:    
                        </div>
                    </div>
                </div>
                <div class="bin report-col" id="bin" droppable drop="handleDrop" bin="bin">
                    <h2>Drag queries here:</h2>
                    <div ng-repeat="drop in dropped track by $index">
                        <h2>{$ drop $}</h2>
                        <a href="" ng-click="removeQuery($index)">remove</a>
                    </div>
                </div> 
            </div>
        </div>
    </div>

    {% block extra_links %}
         <link rel="stylesheet" type="text/css" href="{{ STATIC_PREFIX }}css/reports.css" />
         <link rel="stylesheet" type="text/css" href="{{ STATIC_PREFIX }}css/angular-datepicker.css" />
    {% endblock %}

    {% block extra_scripts %}

        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.0/angular.min.js"></script>
        <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.0/angular-cookies.js"></script>
        <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.0/angular-resource.js"></script>
        <script type="text/javascript" src="{{ STATIC_PREFIX }}js/app.js" ></script>
        <script type="text/javascript" src="{{ STATIC_PREFIX }}js/controllers.js" ></script>
        <script type="text/javascript" src="{{ STATIC_PREFIX }}js/services.js" ></script>
        <script type="text/javascript" src="{{ STATIC_PREFIX }}js/directives.js" ></script>
        <script type="text/javascript" src="{{ STATIC_PREFIX }}js/thirdparty/angular-datepicker.js" ></script>
    {% endblock %}
{% endblock %}
