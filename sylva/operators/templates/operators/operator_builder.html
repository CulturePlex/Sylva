{% extends "base.html" %}
{% load i18n graphs static %}
{% get_static_prefix as STATIC_PREFIX %}

{% block navigation_buttons %}
{{ block.super }}
{% endblock %}

{% block title %}
{{ graph.name }}
{% endblock %}

{% block menu_buttons %}
{% toolbar on="operator" %}
{% endblock %}

{% block content_title %}
{% trans "Operators" as label %}
{% breadcrumb graph label %}
{% endblock %}

{% block content %}
{% if node_types %}
<div style="width: 570px;">
    <div class="nav-links">
        <a id="builder-query"><h2 style="display: inline;">{% trans "Query" %}</h2></a>
        <h2 style="display: inline;"> | </h2>
        <a id="builder-results"><h2 style="display: inline;">{% trans "Results" %}</h2></a>
    </div>
    <div id="query-builder-query">
        <div class="content2-second diagram" style="margin-top: 15px;">
            <nav class="menu" style="float: left;">
            <ul>
                <div id="select-node">
                    <a>{% trans "Type nodes" %}</a>
                    <li>
                        <div id="node-options" style="display: none;">
                            <ul>
                            {% for node_type in node_types %}
                                <li>
                                    <a class="add-box" data-type="{{node_type.slug}}" href="javascript:void(0);">{{ node_type.name|capfirst }}</a>
                                </li>
                            {% endfor %}
                                <li>
                                    <a class="add-box" data-type="wildcard" href="javascript:void(0);">{% trans "Wildcard Type" %}</a>
                                </li>
                            </ul>
                        </div>
                    </li>
                </div>
            </ul>
            </nav>
            <div id="diagramContainer" style="width: 1000px; margin-top: 20px;">
                <div id="diagram"></div>
            </div>
            <input type="hidden" id="id_diagram_positions" name="diagram_positions" value="{{ graph.schema.get_options.diagram_positions }}"/>
            <input type="hidden" id="id_diagram_positions_url" name="diagram_positions" value="{% url schama_diagram_positions graph.slug %}"/>
        </div>
        <a class="button" id="run-button" href="#" style="margin-top: 40px; margin-left: 30px;">{% trans "Run" %}</a>
    </div>
    <div id="query-builder-results">
        <div id="results"></div>
    </div>
</div>
{% endif %}
{% endblock %}

{% block extra_links %}
<link rel="stylesheet" type="text/css" href="{{ STATIC_PREFIX }}css/schemas.diagram.css" />
<!--<link rel="stylesheet" type="text/css" href="{{STATIC_PREFIX}}operators/css/operators.datepicker.css" />-->
<link rel="stylesheet" type="text/css" href="{{ STATIC_PREFIX }}css/chosen.css" />
<link href="{{ STATIC_PREFIX }}css/token.input.css" type="text/css" rel="stylesheet" />
<link href="{{ STATIC_PREFIX }}css/jqueryui.1.8.18.css" type="text/css" rel="stylesheet" />
{% endblock %}
{% block extra_scripts %}
<!--<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.13/jquery-ui.min.js"></script>-->
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.1/jquery-ui.min.js"></script>
<!--<script type="text/javascript" src="{{ STATIC_PREFIX }}js/jquery.jsplumb.1.3.9.min.js"></script>-->
<script type="text/javascript" src="{{ STATIC_PREFIX }}js/jquery.jsPlumb-1.5.5-min.js "></script>
<script type="text/javascript" src="{{ STATIC_PREFIX }}js/jquery.scrollto.min.js"></script>
<script type="text/javascript" src="{{ STATIC_PREFIX }}js/chosen.jquery.min.js"></script>
<script type="text/javascript" src="{{ STATIC_PREFIX }}js/chosen.ajax.js"></script>
<script type="text/javascript" src="{{ STATIC_PREFIX }}js/jqueryui.timepicker.js"></script>
<script type="text/javascript" src="{{ STATIC_PREFIX }}operators/js/operators.query.js"></script>
<script type="text/javascript">
if (!diagram) {
    var diagram = {};
}

diagram.Models = {% autoescape off %}{{ graph.schema.get_schema_diagram }}{% endautoescape %};

diagram.url_collaborators = "{% url graph_query_collaborators graph.slug %}";
diagram.url_query = "{% url operator_builder_results graph.slug %}";

(function ($) {

    $('.body-inside').css({
        "width": "570px"
    });

    $('#builder-query').on('click', function() {
        $('#builder-results h2').css({
            "color": "#348E82"
        });
        $('#query-builder-results').hide();
        $('#query-builder-query').show();
        $('#results').hide();
    });

    $('#builder-results').on('click', function() {
        $('#query-builder-query').hide();
        $('#query-builder-results').show();
        $('#results').show();
    });

    $('#select-node').on('mouseover', function() {
        $('#node-options').css({
            "display": "block"
        });
    });

    $('#select-node').on('mouseout', function() {
        $('#node-options').css({
            "display": "none"
        });
    });

})(jQuery);

</script>
{% endblock %}
