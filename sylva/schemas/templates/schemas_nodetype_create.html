{% extends "base.html" %}
{% load i18n %}

{% block extra_scripts %}
    <script type="text/javascript" src="{{ STATIC_PREFIX }}js/jquery.formsets.1.2.min.js"></script>
{% endblock %}

{% block navigation_buttons %}
{{ block.super }}
{% endblock %}

{% block title %}
{{ graph.name }}
{% endblock %}

{% block menu_buttons %}
<li><a href="{% url graph_view graph.id %}" class="link"><span>{% trans "Graph" %}</span></a></li>
<li><a href="{% url nodes_list graph.id %}" class="link"><span>{% trans "Nodes" %}</span></a></li>
<li><a href="{% url relationships_list graph.id %}" class="link"><span>{% trans "Relationships" %}</span></a></li>
<li><a href="{% url schema_edit graph.id %}" class="text"><span>{% trans "Schema" %}</span></a></li>
<li><a href="{% url graph_collaborators graph.id %}" class="link"><span>{% trans "Collaborators" %}</span></a></li>
{% endblock %}

{% block content_title %}
<h2>{% trans "Graphs" %} » {{ graph.name|truncatewords_html:5 }} » {% trans "Schema" %} » {% trans "New Type" %}</h2>
{% endblock %}

{% block content %}
<div id="content2">
<form action="." method="POST" id="nodeType">
{% csrf_token %}
{{ formset.management_form }}
    <div class="content2-first">
        <h2>{% trans "Type" %}</h2>

            {{ form.as_p }}
            <input type="submit" value="Save Type"/>
            <span class="buttonLinkOption">{% trans "or" %} <a href="{% url schema_edit graph.id %}">{% trans "Cancel" %}</a>.</span>
    </div>
    <div class="content-divider"></div>
    <div class="content2-second">
        <h2>{% trans "Properties" %}</h2>
        <table cellspacing="0" class="nodetype-properties-table" width="100%">
<!--            <thead>-->
<!--                <tr>-->
<!--                    <th>{% trans "Name" %}</th>-->
<!--                    <th>{% trans "Default" %}</th>-->
<!--                    <th>{% trans "Data" %}</th>-->
<!--                    <th>{% trans "Required" %}</th>-->
<!--                    <th>{% trans "Description" %}</th>-->
<!--                    <th>{% trans "Delete" %}</th>-->
<!--                </tr>-->
<!--            </thead>-->
            <tbody>
            {% for form in formset.forms %}
                <tr class="formset {% cycle "row1" "row2" %}">
                    <td>
                        {{ form.key.errors }}
                        {{ form.key.label_tag }}
                        {{ form.key }}
                        {{ form.key.help_text }}
                        <div>
                        {{ form.required.errors }}
                        {{ form.required }}
                        <span>
                        {{ form.required.label_tag }}
                        <span>
                        {{ form.required.help_text }}
                        </div>
                    </td>
                    <td>
                        <!-- I'm really sad about this :'( -->
                        <table class="subform">
                            <tr>
                            <td>
                                {{ form.datatype.errors }}
                                {{ form.datatype.label_tag }}
                                {{ form.datatype }}
                                {{ form.datatype.help_text }}
                            </td>
                            <td>
                                {{ form.default.errors }}
                                {{ form.default.label_tag }}
                                {{ form.default }}
                                {{ form.default.help_text }}
                            </td>
                            <td>
                                <span class="number">
                                {{ form.order.errors }}
                                {{ form.order.label_tag }}
                                {{ form.order }}
                                {{ form.order.help_text }}
                                </span>
                            </td>
                            </tr><tr>
                            <td colspan="3">
                                {{ form.description.errors }}
                                {{ form.description.label_tag }}
                                {{ form.description }}
                                {{ form.description.help_text }}
                            </td>
                            </tr>
                        </table>
                    </td>
                    <td class="delete">{% if form.instance.pk %}{{ form.DELETE }}{% endif %}</td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
<!--    <span class="buttonLinkOption">{% trans "or" %} <a href="{% url schema_edit graph.id %}">{% trans "Advanced Mode" %}</a>.</span>-->
    </div>
<!--    <div class="content-divider"></div>-->
<!--    <div class="content3-block">-->
<!--        <h2>{% trans "Relationship" %}</h4>-->
<!--    </div>-->
</form>
</div>

<script type="text/javascript">
   $(function() {
       $('#nodeType tbody tr.formset').formset({
            addCssClass: "button",
            addText: "{% trans "New Property" %}",
            extraClasses: ['row1', 'row']
       });
   })
</script>
{% endblock %}
